import{a as b,t as m,c as Ve}from"../chunks/disclose-version.CdZuIc7i.js";import"../chunks/legacy.CsAF3hgt.js";import{p as Ue,c as r,r as t,s as o,t as _,a as Oe,f as he,g as a,n as ge,aw as f,m as fe,b as T}from"../chunks/runtime.DFuotMX-.js";import{s as p,e as k}from"../chunks/render.DdyBg62a.js";import{i as L,s as Ge,a as ye}from"../chunks/store.daZB09SA.js";import{e as N,i as J}from"../chunks/each.DwzIx-JD.js";import{r as I,s as Ke}from"../chunks/attributes.BFnUm24A.js";import{s as te}from"../chunks/class.BVZzqmLw.js";import{b as R,a as Me}from"../chunks/input.BWrmKwv7.js";import{p as Qe}from"../chunks/event-modifiers.CWmzcjye.js";import{i as Ce}from"../chunks/lifecycle.DL_zfByv.js";import{p as B}from"../chunks/props.7yD5DXMa.js";import{o as We}from"../chunks/index-client.D03nj6NQ.js";import{w as xe}from"../chunks/index.BTgz_x7K.js";import{z as ee}from"../chunks/index.DHHRaryC.js";import{f as Xe}from"../chunks/validation.srizZMwT.js";const Ye=ee.object({subject:ee.string().max(7,"Predmet môže mať maximálne 7 znakov"),teacher:ee.string().max(20,"Učiteľ môže mať maximálne 20 znakov").regex(/^\w+(\s+\w+)?$/,"Učiteľ musí mať iba meno alebo aj priezvisko"),classroom:ee.string().max(6,"Miestnosť môže mať maximálne 6 znakov")}),et={blue:"bg-blue-500",red:"bg-red-500",yellow:"bg-yellow-400",green:"bg-green-700",orange:"bg-orange-400",pink:"bg-pink-400",purple:"bg-purple-400",gray:"bg-gray-400",lightBlue:"bg-blue-300",lime:"bg-green-400"};var tt=m('<p class="text-sm"> </p>'),rt=m('<p class="text-sm"> </p>'),at=m('<span class="absolute top-0 right-0 border-1 text-red-900 hover:text-red-800 cursor-pointer" role="button" tabindex="0" aria-label="Odstrániť"><i class="fas fa-times w-4 h-4"></i></span> <span class="absolute bottom-0 right-0 text-green-900 hover:text-green-800 pr-1 cursor-pointer text-sm" role="button" tabindex="0" aria-label="Upraviť"><i class="fa-solid fa-pen-to-square"></i></span>',1),ot=m('<div><p class="font-semibold"> </p> <p class="text-sm"> </p> <!> <!></div>');function st(re,w){Ue(w,!1);let n=B(w,"item",8),V=B(w,"isEditingSchedule",8),G=B(w,"onDelete",8),j=B(w,"onEdit",8);Ce();var E=ot(),P=r(E),ae=r(P,!0);t(P);var M=o(P,2),S=r(M,!0);t(M);var e=o(M,2);{var z=c=>{var u=tt(),x=r(u);t(u),_(()=>p(x,`Pr.(${n().classroom??""})`)),b(c,u)},U=c=>{var u=Ve(),x=he(u);{var O=l=>{var q=rt(),A=r(q);t(q),_(()=>p(A,`Cv.(${n().classroom??""})`)),b(l,q)};L(x,l=>{n().type==="exercise"&&l(O)},!0)}b(c,u)};L(e,c=>{n().type==="lecture"?c(z):c(U,!1)})}var y=o(e,2);{var Z=c=>{var u=at(),x=he(u),O=o(x,2);k("click",x,l=>{l.stopPropagation(),G()(n().id)}),k("keydown",x,l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),l.stopPropagation(),G()(n().id))}),k("click",O,l=>{l.stopPropagation(),j()(n())}),k("keydown",O,l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),l.stopPropagation(),j()(n()))}),b(c,u)};L(y,c=>{V()&&c(Z)})}t(E),_(()=>{te(E,`relative h-full ${n().color} text-gray-900 rounded p-1 border-2 border-gray-900`),p(ae,n().subject),p(S,n().teacher)}),b(re,E),Oe()}var it=m('<div class="bg-green-500 text-gray-900 p-2 font-bold sticky top-0 z-10 border-2 border-gray-900"> </div>'),lt=m('<button type="button"></button>'),dt=m('<div class="border-2 border-gray-900 p-2 bg-slate-300 text-gray-900 font-bold sticky left-0 z-10"> </div> <!>',1),nt=m('<button type="button"></button>'),ct=m('<div class="text-red-500 text-sm mt-1">Opravte chyby vo formulári a skúste znova.</div>'),vt=m('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"><div class="bg-gray-200 text-gray-900 rounded-lg p-6 shadow-lg border-2 border-slate-900 mx-8 w-full max-w-md"><h2 class="text-xl font-bold mb-4 text-center"> </h2> <form class="flex flex-col gap-4"><div><label for="day" class="block text-sm font-bold mb-1">Deň</label> <input id="day" class="basic-input bg-gray-300 cursor-default" type="text" placeholder="Zadajte deň" readonly=""></div> <div><label for="hour" class="block text-sm font-bold mb-1">Hodina</label> <input id="hour" class="basic-input bg-gray-300 cursor-default" type="text" placeholder="Zadajte hodinu" readonly=""></div> <div><label for="subject" class="block text-sm font-bold mb-1">Predmet</label> <input id="subject" class="basic-input bg-gray-300" type="text" placeholder="Zadajte predmet" required> <p class="text-red-500 text-sm mt-1"> </p></div> <div><label for="teacher" class="block text-sm font-bold mb-1">Učiteľ</label> <input id="teacher" class="basic-input bg-gray-300" type="text" placeholder="Zadajte učiteľa" required> <p class="text-red-500 text-sm mt-1"> </p></div> <div><label for="classroom" class="block text-sm font-bold mb-1">Miestnosť</label> <input id="classroom" class="basic-input bg-gray-300" type="text" placeholder="Zadajte miestnosť" required> <p class="text-red-500 text-sm mt-1"> </p></div> <div><p class="block text-sm font-bold mb-1">Typ výučby</p> <div class="flex items-center gap-4"><label class="flex items-center gap-2"><input type="radio" name="type" class="border-2 border-gray-500 rounded-full p-2"> <span>Prednáška</span></label> <label class="flex items-center gap-2"><input type="radio" name="type" class="border-2 border-gray-500 rounded-full p-2"> <span>Cvičenie</span></label></div></div> <div><p class="block text-sm font-bold mb-1">Farba</p> <div class="flex justify-between"></div></div> <div><!></div> <div class="flex justify-end gap-2"><button type="button" class="py-2 px-4 rounded-md bg-red-600 text-gray-900 font-bold transition duration-300 hover:bg-red-800 border-2 border-gray-900">Zrušiť</button> <button type="submit" class="py-2 px-4 rounded-md bg-green-400 text-gray-900 font-bold transition duration-300 hover:bg-green-600 border-2 border-gray-900">Uložiť</button></div></form></div></div>'),bt=m('<div class="min-h-screen bg-gray-200"><div class="container mx-auto py-6 px-3"><h1 class="font-bold text-3xl text-gray-900 mb-6 text-center">Rozvrh Hodín</h1> <div class="mb-4 text-center"><button type="button"> </button></div> <div class="overflow-x-auto"><div class="grid grid-cols-[100px_repeat(13,_minmax(0,1fr))] grid-rows-[50px_repeat(5,100px)] border-2 border-gray-900 rounded-sm shadow-md"><div class="text-gray-900 p-2 font-bold sticky left-0 top-0 z-20 border-2 border-gray-900"></div> <!> <!></div></div></div> <!></div>');function Dt(re,w){Ue(w,!1);const n=Ge(),V=()=>ye(M,"$schedule",n),G=()=>ye(S,"$showModal",n),j=()=>ye(P,"$formErrors",n),E=[];let P=xe({}),ae=B(w,"data",8);const M=xe(ae().scheduleItems),S=xe(!1);let e=fe({day:"",hour:"",subject:"",teacher:"",classroom:"",type:"lecture",color:"bg-gray-400"}),z=fe(!1),U=null,y=fe(!1);async function Z(){const s=await fetch("/schedule");if(s.ok){const i=await s.json();M.set(i)}}function c(){T(e,{day:"",hour:"",subject:"",teacher:"",classroom:"",type:"lecture",color:"bg-gray-400"}),T(z,!1),U=null,P.set({})}function u(s,i){V().find(v=>v.day===s&&v.hour===i)||(f(e,a(e).day=s),f(e,a(e).hour=i),T(z,!1),S.set(!0))}function x(s){T(e,{...s}),T(z,!0),U=s.id,S.set(!0)}async function O(){const s=Ye.safeParse(a(e));if(!s.success){const i=Xe(s.error.errors);P.set(i);return}try{a(z)&&U?await fetch(`/schedule/${U}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a(e))}):await fetch("/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a(e))}),await Z(),S.set(!1),c()}catch(i){console.error("Error saving item:",i)}}async function l(s){try{await fetch(`/schedule?id=${s}`,{method:"DELETE"}),await Z()}catch(i){console.error("Error deleting item:",i)}}function q(){T(y,!a(y))}We(Z),Ce();var A=bt(),oe=r(A),se=o(r(oe),2),K=r(se),Te=r(K,!0);t(K),t(se);var _e=o(se,2),ke=r(_e),we=o(r(ke),2);N(we,0,()=>Array.from({length:13},(s,i)=>7+i),J,(s,i)=>{var g=it(),v=r(g);t(g),_(()=>p(v,`${i??""}:00`)),b(s,g)});var Ze=o(we,2);N(Ze,0,()=>["Pondelok","Utorok","Streda","Štvrtok","Piatok"],J,(s,i)=>{var g=dt(),v=he(g),ie=r(v,!0);t(v);var F=o(v,2);N(F,0,()=>Array.from({length:13},(C,D)=>7+D),J,(C,D)=>{var h=lt();N(h,5,()=>V().filter($=>$.day===i&&$.hour===`${D}:00`),J,($,H)=>{st($,{get item(){return a(H)},get isEditingSchedule(){return a(y)},onDelete:l,onEdit:x})}),t(h),_(()=>te(h,`w-full border-2 border-gray-900 p-1 cursor-pointer text-left relative ${a(y)?"hover:bg-green-700 hover:bg-opacity-30 hover:text-gray-900":"cursor-auto bg-gray-200 text-gray-400"}`)),k("click",h,()=>{a(y)&&u(i,`${D}:00`)}),b(C,h)}),_(()=>p(ie,i)),b(s,g)}),t(ke),t(_e),t(oe);var qe=o(oe,2);{var Ae=s=>{var i=vt(),g=r(i),v=r(g),ie=r(v,!0);t(v);var F=o(v,2),C=r(F),D=o(r(C),2);I(D),t(C);var h=o(C,2),$=o(r(h),2);I($),t(h);var H=o(h,2),le=o(r(H),2);I(le);var je=o(le,2),Fe=r(je,!0);t(je),t(H);var de=o(H,2),ne=o(r(de),2);I(ne);var Ee=o(ne,2),He=r(Ee,!0);t(Ee),t(de);var ce=o(de,2),ve=o(r(ce),2);I(ve);var Pe=o(ve,2),Ne=r(Pe,!0);t(Pe),t(ce);var be=o(ce,2),Se=o(r(be),2),ue=r(Se),Q=r(ue);I(Q),Q.value=(Q.__value="lecture")==null?"":"lecture",ge(2),t(ue);var ze=o(ue,2),W=r(ze);I(W),W.value=(W.__value="exercise")==null?"":"exercise",ge(2),t(ze),t(Se),t(be);var pe=o(be,2),De=o(r(pe),2);N(De,5,()=>Object.entries(et),J,(d,X)=>{let Le=()=>a(X)[0],Ie=()=>a(X)[1];var Y=nt();_(()=>{te(Y,`rounded-md border-2 border-slate-900 p-3 focus:border-green-400 focus:border-2 ${Ie()}`),Ke(Y,"aria-label",Le())}),k("click",Y,()=>f(e,a(e).color=Ie())),b(d,Y)}),t(De),t(pe);var me=o(pe,2),Je=r(me);{var Re=d=>{var X=ct();b(d,X)};L(Je,d=>{Object.keys(j()).length>0&&d(Re)})}t(me);var $e=o(me,2),Be=r($e);ge(2),t($e),t(F),t(g),t(i),_(()=>{p(ie,a(z)?"Uprav predmet":"Pridaj predmet"),p(Fe,j().subject),p(He,j().teacher),p(Ne,j().classroom)}),R(D,()=>a(e).day,d=>f(e,a(e).day=d)),R($,()=>a(e).hour,d=>f(e,a(e).hour=d)),R(le,()=>a(e).subject,d=>f(e,a(e).subject=d)),R(ne,()=>a(e).teacher,d=>f(e,a(e).teacher=d)),R(ve,()=>a(e).classroom,d=>f(e,a(e).classroom=d)),Me(E,[],Q,()=>a(e).type,d=>f(e,a(e).type=d)),Me(E,[],W,()=>a(e).type,d=>f(e,a(e).type=d)),k("click",Be,()=>{c(),S.set(!1)}),k("submit",F,Qe(O)),b(s,i)};L(qe,s=>{G()&&s(Ae)})}t(A),_(()=>{te(K,`py-1 px-4 rounded-md font-bold transition duration-300 border-2 border-gray-900 ${a(y)?"bg-red-500 hover:bg-red-600 text-gray-900":"bg-blue-500 hover:bg-blue-600 text-gray-900"}`),p(Te,a(y)?"Skončiť úpravy":"Upraviť rozvrh")}),k("click",K,q),b(re,A),Oe()}export{Dt as component};
